{% extends 'base.html' %}
{% block content %}
  <div class="editor-layout">
    <!-- Cá»™t trÃ¡i: preview & canvas -->
    <section class="editor-main">
      <div class="preview-header">
        <h2>TrÃ¬nh chá»‰nh sá»­a áº£nh cÆ¡ báº£n</h2>
        <span class="tag">ONLINE Â· AI FACE BLUR</span>
      </div>

      <div class="canvas-container" id="canvas-container">
        <div id="placeholder">ChÆ°a cÃ³ áº£nh. HÃ£y táº£i áº£nh, dÃ¡n áº£nh, hoáº·c chá»¥p tá»« webcam.</div>
        <canvas id="editorCanvas"></canvas>
      </div>

      <div class="toolbar-row">
        <button class="btn" id="btn-open-camera">ğŸ“· Chá»¥p áº£nh</button>
        <button class="btn" id="btn-close-camera">âœ– Táº¯t camera</button>
        <button class="btn" id="btn-upload">ğŸ“‚ Táº£i áº£nh lÃªn</button>
        <input type="file" id="file-input" accept="image/*" hidden />
        <span class="hint">Tip: CÃ³ thá»ƒ copy áº£nh trÃªn máº¡ng rá»“i <b>Ctrl+V</b> Ä‘á»ƒ dÃ¡n vÃ o.</span>
      </div>

      <div class="toolbar-row">
        <button class="btn" id="btn-undo">â†¶ Quay láº¡i</button>
        <button class="btn" id="btn-redo">â†· Tiáº¿n tá»›i</button>
        <button class="btn" id="btn-original">áº¢nh gá»‘c</button>
        <button class="btn" id="btn-delete-current">XÃ³a áº£nh hiá»‡n táº¡i</button>
      </div>

      <div class="toolbar-row">
        <button class="btn" id="btn-grayscale">Äen tráº¯ng</button>
        <button class="btn" id="btn-blur">LÃ m má»</button>
        <button class="btn" id="btn-rotate">Xoay 90Â°</button>
        <button class="btn" id="btn-flip">Láº­t ngang</button>
        <button class="btn" id="btn-brightness-plus">+ SÃ¡ng</button>
        <button class="btn" id="btn-brightness-minus">- SÃ¡ng</button>
        <button class="btn" id="btn-face-blur">ğŸ¤– LÃ m má» khuÃ´n máº·t (AI)</button>
      </div>

      <!-- Background -->
      <div class="toolbar-row">
        <button class="btn" id="btn-blur-bg">LÃ m má» background</button>

        <label class="inline">
          MÃ u ná»n:
          <input type="color" id="bg-color-picker" value="#1a1c28" />
        </label>
        <button class="btn" id="btn-change-bg">Äá»•i background</button>

        <button class="btn" id="btn-remove-bg">XÃ³a ná»n (PNG trong suá»‘t)</button>
      </div>

      <!-- Tone mÃ u -->
      <div class="toolbar-row">
        <button class="btn" id="btn-summer-tone">ğŸ¨ Tone mÃ¹a hÃ¨ (nhanh)</button>
        <span>Hoáº·c chá»n tone:</span>
        <select id="tone-select">
          <option value="none">-- Chá»n tone --</option>
          <option value="summer">MÃ¹a hÃ¨</option>
          <option value="forest">Rá»«ng xanh</option>
          <option value="sunset">HoÃ ng hÃ´n</option>
        </select>
        <button class="btn" id="btn-apply-tone">Ãp dá»¥ng tone</button>
      </div>

      <!-- Cáº¯t + Zoom -->
      <div class="toolbar-row">
        <button class="btn" id="btn-crop">âœ‚ Cáº¯t áº£nh (zoom vÃ o giá»¯a)</button>
        <button class="btn" id="btn-zoom-in">ğŸ” Zoom +</button>
        <button class="btn" id="btn-zoom-out">ğŸ” Zoom âˆ’</button>
      </div>

      <div class="toolbar-row">
        <button class="btn" id="btn-pencil">âœ BÃºt chÃ¬</button>
        <label class="inline">MÃ u:<input type="color" id="pencil-color" value="#00ffcc" /></label>
        <label class="inline">Size:<input type="range" id="pencil-size" min="2" max="40" value="8" /></label>
        <button class="btn" id="btn-pencil-off">Táº¯t váº½</button>
      </div>

      <div class="toolbar-row">
        <span>Emoji che máº·t:</span>
        <select id="emoji-select">
          <option value="smile">ğŸ˜€ Smile</option>
          <option value="heart">â¤ï¸ Heart</option>
          <option value="star">â­ Star</option>
          <option value="cool">ğŸ˜ Cool</option>
        </select>
        <button class="btn" id="btn-emoji-face">Che máº·t báº±ng emoji</button>
      </div>

      <div class="toolbar-row">
        <button class="btn btn-primary" id="btn-download-png">Táº£i áº£nh (.png)</button>
        <button class="btn btn-secondary" id="btn-download-jpg">Táº£i áº£nh (.jpg)</button>
      </div>

      <!-- Webcam preview trong editor -->
      <video id="camVideo" autoplay playsinline class="hidden"></video>

      <!-- NÃºt chá»¥p áº£nh tá»« webcam -->
      <div class="toolbar-row" id="cam-capture-row" style="display:none;">
        <button class="btn" id="btn-capture-photo">ğŸ“¸ Chá»¥p & Ä‘Æ°a vÃ o khu chá»‰nh sá»­a</button>
      </div>
    </section>

    <!-- Cá»™t pháº£i: Gallery -->
    <aside class="editor-sidebar">
      <h3>áº¢nh Ä‘Ã£ lÆ°u trong phiÃªn</h3>
      <div id="gallery" class="gallery-grid">
        <!-- thumbnail sáº½ add báº±ng JS -->
      </div>
    </aside>
  </div>

  <script src="{{ url_for('static', filename='js/editor.js') }}"></script>
{% endblock %}
